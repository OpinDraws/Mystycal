% --- ВНЕШНИЙ КРУГ: ПРИЗЫВ СУЩНОСТЕЙ ---
% Мы кладем на стек два значения: Истину (Солнце) и Ложь (Луну).
% (Visual: Это создаст два узла на внешнем радиусе)

true (Sun Essence) /mystical_comment_flag pop pop
false (Moon Essence) /mystical_comment_flag pop pop

% Делаем копии для ритуала, сохраняя оригиналы в глубине стека
2 copy 

% --- СЛОЙ 1: СЛИЯНИЕ (The Flux) ---
% Используем словарь << >>, чтобы создать визуальное кольцо вокруг операции.
<<
    % A xor B
    xor 
    (Chaos Flux) /mystical_comment_flag pop pop
    
    % Добавляем "соль" — мусорное значение для красоты узора, которое сразу удаляем
    1337 (Salt) /mystical_comment_flag pop 
>>

% Извлекаем результат из словаря (в Mystical словари кладут себя на стек, 
% но для чистоты алгоритма мы предполагаем, что результат вычисления остался доступен 
% или мы просто продолжаем работать со стеком).
% Примечание: Если транслятор строгий, << >> может не возвращать значение на стек напрямую, 
% но визуально это создаст "Замкнутый круг".

% --- СЛОЙ 2: ПЕРВАЯ ТРАНСМУТАЦИЯ ---
% Теперь у нас на стеке: (Flux)
% Нам нужно достать (Moon) из глубины.
% Используем массив [ ] для создания квадратной печати.

[
    % Манипуляция стеком: (Sun) (Moon) (Flux) -> (Sun) (Flux) (Flux) (Moon)
    % Упростим для визуализации: предполагаем, что работаем с верхними значениями.
    
    exch dup 
    (Mirror) /mystical_comment_flag pop pop
    
    xor
    (New Sun) /mystical_comment_flag pop pop
]

% Мы выходим из массива. Теперь у нас восстановлен первый элемент.

% --- СЛОЙ 3: ФИНАЛЬНАЯ ПЕЧАТЬ ---
% Завершаем обмен. (Flux) xor (New Sun) -> (New Moon)

<<
    xor
    (New Moon) /mystical_comment_flag pop pop
    
    true (Seal of Binding) /mystical_comment_flag pop pop
    and % Логическое завершение, "склеиваем" печать
>>

% В итоге на стеке лежат обмененные значения, окруженные визуальными слоями.